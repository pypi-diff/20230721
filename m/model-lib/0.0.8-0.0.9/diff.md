# Comparing `tmp/model_lib-0.0.8-py3-none-any.whl.zip` & `tmp/model_lib-0.0.9-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,26 +1,26 @@
-Zip file size: 24233 bytes, number of entries: 24
--rw-r--r--  2.0 unx     1265 b- defN 23-Apr-06 20:12 model_lib/__init__.py
--rw-r--r--  2.0 unx     7147 b- defN 23-Apr-06 20:12 model_lib/base_settings.py
--rw-r--r--  2.0 unx      601 b- defN 23-Apr-06 20:12 model_lib/constants.py
--rw-r--r--  2.0 unx     1863 b- defN 23-Apr-06 20:12 model_lib/dump_functions.py
--rw-r--r--  2.0 unx     1631 b- defN 23-Apr-06 20:12 model_lib/errors.py
--rw-r--r--  2.0 unx     3403 b- defN 23-Apr-06 20:12 model_lib/model_base.py
--rw-r--r--  2.0 unx     3095 b- defN 23-Apr-06 20:12 model_lib/model_dump.py
--rw-r--r--  2.0 unx     3101 b- defN 23-Apr-06 20:12 model_lib/pydantic_utils.py
--rw-r--r--  2.0 unx      439 b- defN 23-Apr-06 20:12 model_lib/metadata/__init__.py
--rw-r--r--  2.0 unx     5607 b- defN 23-Apr-06 20:12 model_lib/metadata/context_dict.py
--rw-r--r--  2.0 unx     1350 b- defN 23-Apr-06 20:12 model_lib/metadata/metadata.py
--rw-r--r--  2.0 unx     2558 b- defN 23-Apr-06 20:12 model_lib/metadata/metadata_dump.py
--rw-r--r--  2.0 unx     1277 b- defN 23-Apr-06 20:12 model_lib/metadata/metadata_fields.py
--rw-r--r--  2.0 unx      426 b- defN 23-Apr-06 20:12 model_lib/serialize/__init__.py
--rw-r--r--  2.0 unx     1690 b- defN 23-Apr-06 20:12 model_lib/serialize/base_64.py
--rw-r--r--  2.0 unx     3286 b- defN 23-Apr-06 20:12 model_lib/serialize/dump.py
--rw-r--r--  2.0 unx     1773 b- defN 23-Apr-06 20:12 model_lib/serialize/json_serialize.py
--rw-r--r--  2.0 unx     6356 b- defN 23-Apr-06 20:12 model_lib/serialize/parse.py
--rw-r--r--  2.0 unx     9871 b- defN 23-Apr-06 20:12 model_lib/serialize/yaml_serialize.py
--rw-r--r--  2.0 unx     2603 b- defN 23-Apr-06 20:12 model_lib-0.0.8.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 23-Apr-06 20:12 model_lib-0.0.8.dist-info/WHEEL
--rw-r--r--  2.0 unx        1 b- defN 23-Apr-06 20:12 model_lib-0.0.8.dist-info/namespace_packages.txt
--rw-r--r--  2.0 unx       10 b- defN 23-Apr-06 20:12 model_lib-0.0.8.dist-info/top_level.txt
-?rw-rw-r--  2.0 unx     2032 b- defN 23-Apr-06 20:12 model_lib-0.0.8.dist-info/RECORD
-24 files, 61477 bytes uncompressed, 20931 bytes compressed:  66.0%
+Zip file size: 24398 bytes, number of entries: 24
+-rw-r--r--  2.0 unx     1352 b- defN 23-Apr-25 06:38 model_lib/__init__.py
+-rw-r--r--  2.0 unx     7147 b- defN 23-Apr-25 06:38 model_lib/base_settings.py
+-rw-r--r--  2.0 unx      601 b- defN 23-Apr-25 06:38 model_lib/constants.py
+-rw-r--r--  2.0 unx     1863 b- defN 23-Apr-25 06:38 model_lib/dump_functions.py
+-rw-r--r--  2.0 unx     1631 b- defN 23-Apr-25 06:38 model_lib/errors.py
+-rw-r--r--  2.0 unx     3299 b- defN 23-Apr-25 06:38 model_lib/model_base.py
+-rw-r--r--  2.0 unx     3095 b- defN 23-Apr-25 06:38 model_lib/model_dump.py
+-rw-r--r--  2.0 unx     3101 b- defN 23-Apr-25 06:38 model_lib/pydantic_utils.py
+-rw-r--r--  2.0 unx      813 b- defN 23-Apr-25 06:38 model_lib/metadata/__init__.py
+-rw-r--r--  2.0 unx     5607 b- defN 23-Apr-25 06:38 model_lib/metadata/context_dict.py
+-rw-r--r--  2.0 unx     1350 b- defN 23-Apr-25 06:38 model_lib/metadata/metadata.py
+-rw-r--r--  2.0 unx     2558 b- defN 23-Apr-25 06:38 model_lib/metadata/metadata_dump.py
+-rw-r--r--  2.0 unx     1277 b- defN 23-Apr-25 06:38 model_lib/metadata/metadata_fields.py
+-rw-r--r--  2.0 unx      791 b- defN 23-Apr-25 06:38 model_lib/serialize/__init__.py
+-rw-r--r--  2.0 unx     1647 b- defN 23-Apr-25 06:38 model_lib/serialize/base_64.py
+-rw-r--r--  2.0 unx     3357 b- defN 23-Apr-25 06:38 model_lib/serialize/dump.py
+-rw-r--r--  2.0 unx     1773 b- defN 23-Apr-25 06:38 model_lib/serialize/json_serialize.py
+-rw-r--r--  2.0 unx     6362 b- defN 23-Apr-25 06:38 model_lib/serialize/parse.py
+-rw-r--r--  2.0 unx     9868 b- defN 23-Apr-25 06:38 model_lib/serialize/yaml_serialize.py
+-rw-r--r--  2.0 unx     2601 b- defN 23-Apr-25 06:38 model_lib-0.0.9.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 23-Apr-25 06:38 model_lib-0.0.9.dist-info/WHEEL
+-rw-r--r--  2.0 unx        1 b- defN 23-Apr-25 06:38 model_lib-0.0.9.dist-info/namespace_packages.txt
+-rw-r--r--  2.0 unx       10 b- defN 23-Apr-25 06:38 model_lib-0.0.9.dist-info/top_level.txt
+?rw-rw-r--  2.0 unx     2032 b- defN 23-Apr-25 06:38 model_lib-0.0.9.dist-info/RECORD
+24 files, 62228 bytes uncompressed, 21096 bytes compressed:  66.1%
```

## zipnote {}

```diff
@@ -51,23 +51,23 @@
 
 Filename: model_lib/serialize/parse.py
 Comment: 
 
 Filename: model_lib/serialize/yaml_serialize.py
 Comment: 
 
-Filename: model_lib-0.0.8.dist-info/METADATA
+Filename: model_lib-0.0.9.dist-info/METADATA
 Comment: 
 
-Filename: model_lib-0.0.8.dist-info/WHEEL
+Filename: model_lib-0.0.9.dist-info/WHEEL
 Comment: 
 
-Filename: model_lib-0.0.8.dist-info/namespace_packages.txt
+Filename: model_lib-0.0.9.dist-info/namespace_packages.txt
 Comment: 
 
-Filename: model_lib-0.0.8.dist-info/top_level.txt
+Filename: model_lib-0.0.9.dist-info/top_level.txt
 Comment: 
 
-Filename: model_lib-0.0.8.dist-info/RECORD
+Filename: model_lib-0.0.9.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## model_lib/__init__.py

```diff
@@ -1,8 +1,9 @@
 """isort:skip_file."""
+from model_lib.constants import FileFormat
 from model_lib.errors import (
     UnknownModelError,
     ClsNameAlreadyExist,
     NoDumper,
     DumperExist,
     EnvVarParsingFailure,
 )
@@ -26,21 +27,22 @@
 from model_lib.dump_functions import dump_ignore_falsy
 from model_lib.pydantic_utils import (
     copy_and_validate,
     utc_datetime,
     utc_datetime_ms,
     field_names,
 )
-from model_lib.serialize import *
+from model_lib.serialize import *  # noqa F403
 
 UNKNOWN = "_UNKNOWN_"
-__all__ = (
+__all__ = (  # noqa F405
     "BaseEnvVars",
     "Entity",
     "Event",
+    "FileFormat",
     "ModelT",
     "SeqModel",
     "TypeEvent",
     "UnknownModelError",
     "ClsNameAlreadyExist",
     "NoDumper",
     "DumperExist",
```

## model_lib/model_base.py

```diff
@@ -1,10 +1,9 @@
 from __future__ import annotations
 
-from contextlib import suppress
 from functools import cached_property
 from typing import Generic, Iterable, List, Sequence, Type, TypeVar, Union
 
 from model_lib.errors import ClsNameAlreadyExist, UnknownModelError
 from pydantic import BaseModel, Extra
 from zero_3rdparty.object_name import as_name
 from zero_3rdparty.str_utils import want_bool
@@ -40,22 +39,19 @@
             return
         if old_cls := _model_name_to_type.get(cls_name) and not cls_name.startswith(
             "_"
         ):
             raise ClsNameAlreadyExist(as_name(cls), as_name(old_cls))
         _model_name_to_type[cls_name] = cls
 
-        with suppress(ModuleNotFoundError):
-            import yaml
-
     def __eq__(self, other):
         """cached properties are stored on the instance and shouldn't be
         included in comparison."""
         if not isinstance(other, BaseModel):
-            raise TypeError
+            return False
         return self.dict() == other.dict()
 
     def dict(
         self,
         *,
         include: Union["AbstractSetIntStr", "MappingIntStrAny"] = None,  # noqa
         exclude: Union["AbstractSetIntStr", "MappingIntStrAny"] = None,  # noqa
```

## model_lib/metadata/__init__.py

```diff
@@ -1,7 +1,8 @@
+"""isort:skip_file."""
 from model_lib.metadata.metadata_fields import EventMetadata, iter_tags
 from model_lib.metadata.metadata import (
     current_metadata,
     metadata_from_context_dict,
     pop_metadata,
     read_metadata,
     read_metadata_or_none,
@@ -11,7 +12,24 @@
 from model_lib.metadata.metadata_dump import (
     add_metadata_dumper,
     dump_metadata,
     get_metadata_dumpers,
     metadata_dumper,
     set_metadata_dumpers,
 )
+
+__all__ = (
+    "EventMetadata",
+    "add_metadata_dumper",
+    "current_metadata",
+    "dump_metadata",
+    "get_metadata_dumpers",
+    "iter_tags",
+    "metadata_dumper",
+    "metadata_from_context_dict",
+    "pop_metadata",
+    "read_metadata",
+    "read_metadata_or_none",
+    "set_metadata",
+    "set_metadata_dumpers",
+    "update_metadata",
+)
```

## model_lib/serialize/__init__.py

```diff
@@ -1,7 +1,8 @@
+"""isort:skip_file."""
 from model_lib.serialize.base_64 import (
     decode_base64,
     encode_base64,
     generate_secret_base_64,
 )
 from model_lib.serialize.dump import (
     dump,
@@ -14,7 +15,24 @@
 )
 from model_lib.serialize.parse import (
     parse_model,
     parse_model_metadata,
     parse_model_name_kwargs_list,
     parse_payload,
 )
+
+__all__ = (
+    "decode_base64",
+    "dump",
+    "dump_as_dict",
+    "dump_as_list",
+    "dump_as_type_dict",
+    "dump_as_type_dict_list",
+    "dump_safe",
+    "dump_with_metadata",
+    "encode_base64",
+    "generate_secret_base_64",
+    "parse_model",
+    "parse_model_metadata",
+    "parse_model_name_kwargs_list",
+    "parse_payload",
+)
```

## model_lib/serialize/base_64.py

```diff
@@ -1,39 +1,38 @@
 from base64 import b64decode, b64encode
 from functools import singledispatch
 from secrets import token_bytes
-from typing import Any, Final, Literal
+from typing import Final, Literal
 
 # See https://tools.ietf.org/html/rfc3548.html
 BASE64_CHARACTER_SET: Final[
     Literal["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="]
 ] = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="
 
 
 @singledispatch
 def encode_base64(b: str | bytes) -> str:
     raise NotImplementedError
 
 
 @encode_base64.register
-def encode_base64_str(b: bytes) -> str:
+def _encode_base64_bytes(b: bytes) -> str:
     return b64encode(b).decode("utf-8")
 
 
 @encode_base64.register
-def encode_base64_str(s: str) -> str:
+def _encode_base64_str(s: str) -> str:
     """
     >>> encode_base64('default:default')
     'ZGVmYXVsdDpkZWZhdWx0'
 
     :param s:
     :return:
     """
-    b = s.encode(encoding="utf-8")
-    return b64encode(b).decode("utf-8")
+    return encode_base64(s.encode(encoding="utf-8"))
 
 
 @singledispatch
 def decode_base64(b: str | bytes) -> str:
     """
     >>> decode_base64('ZGVmYXVsdDpkZWZhdWx0')
     'default:default'
@@ -47,22 +46,21 @@
     Raises:
         binascii.Error
     """
     raise NotImplementedError
 
 
 @decode_base64.register
-def decode_base64_bytes(b: bytes):
+def _decode_base64_bytes(b: bytes):
     return b64decode(b).decode("utf-8")
 
 
 @decode_base64.register
-def decode_base64_str(s: str) -> str:
-    b = s.encode(encoding="utf-8")
-    return b64decode(b).decode("utf-8")
+def _decode_base64_str(s: str) -> str:
+    return decode_base64(s.encode(encoding="utf-8"))
 
 
 def generate_secret_base_64(token_bytes_size: int = 16) -> str:
     """
     >>> len(generate_secret_base_64())
     24
     >>> len(generate_secret_base_64(token_bytes_size=24))
```

## model_lib/serialize/dump.py

```diff
@@ -8,39 +8,38 @@
     METADATA_DUMP_KEY,
     METADATA_MODEL_NAME_FIELD,
     MODEL_DUMP_KEY,
 )
 from model_lib.errors import FileFormat
 from model_lib.metadata.metadata_dump import dump_metadata
 from model_lib.model_dump import registered_types
+from model_lib.serialize.json_serialize import dump as _dump_json
+from model_lib.serialize.json_serialize import parse as _parse_json
+from model_lib.serialize.json_serialize import pretty_dump as _dump_pretty_json
+from model_lib.serialize.yaml_serialize import dump_yaml_str
 
 from model_lib import ModelT
 
-from .json_serialize import dump as _dump_json
-from .json_serialize import parse as _parse_json
-from .json_serialize import pretty_dump as _dump_pretty_json
-from .yaml_serialize import dump_yaml_str
-
 logger = logging.getLogger(__name__)
 
 
 _payload_dumpers = {
     FileFormat.json: _dump_json,
     FileFormat.yaml: dump_yaml_str,
     FileFormat.yml: dump_yaml_str,
     FileFormat.pretty_json: _dump_pretty_json,
 }
 
 
 def dump(instance: object, format: FileFormat | str) -> str:
     """
-    Raises:
-        JSONEncodeError
+    >>> dump('', "json")
+    ''
     """
-    if instance is "":
+    if instance == "":
         #: special case where we would get '""' otherwise
         return ""
     dumper = _payload_dumpers[format]
     return dumper(instance)
 
 
 def dump_as_dict(instance: object) -> dict:
```

## model_lib/serialize/json_serialize.py

 * *Ordering differences only*

```diff
@@ -1,15 +1,15 @@
 from __future__ import annotations
+
 import logging
 from contextlib import suppress
 from typing import Any, Callable, TypeAlias, TypeVar
 
 from model_lib.model_dump import dump as model_dump
 
-
 logger = logging.getLogger(__name__)
 T = TypeVar("T")
 
 dump_call: TypeAlias = Callable[[T], str]
 dump_parse: TypeAlias = tuple[dump_call, dump_call, Callable[[str], Any]] | None
```

## model_lib/serialize/parse.py

```diff
@@ -49,15 +49,15 @@
         return file_format
     raise NotImplementedError
 
 
 def parse_model(
     payload: PayloadT,
     t: Optional[Type[T]] = None,
-    format: FileFormat = FileFormat.json,
+    format: FileFormat | str = FileFormat.json,
     extra_kwargs: Mapping[str, Any] | None = None,
 ) -> T:
     model, _ = parse_model_metadata(
         payload, t=t, format=format, extra_kwargs=extra_kwargs
     )
     return model
```

## model_lib/serialize/yaml_serialize.py

```diff
@@ -62,15 +62,15 @@
             default_flow_style=default_flow_style,
             width=width,
             allow_unicode=allow_unicode,
             sort_keys=sort_keys,
         )
     except yaml.representer.RepresenterError as e:
         _, maybe_base_model = e.args
-        logger.warning(
+        logger.info(
             f"not yaml serializable, trying re-register: {type(maybe_base_model)}"
         )
         if isinstance(maybe_base_model, BaseModel):
             try:
                 register_dumper(
                     type(maybe_base_model), base_model_dumper, allow_override="never"
                 )
```

## Comparing `model_lib-0.0.8.dist-info/METADATA` & `model_lib-0.0.9.dist-info/METADATA`

 * *Files 2% similar despite different names*

```diff
@@ -1,20 +1,20 @@
 Metadata-Version: 2.1
 Name: model-lib
-Version: 0.0.8
+Version: 0.0.9
 Summary: base models, metadata, and how to dump them to json|yaml
 Home-page: https://github.com/EspenAlbert/py-libs
 Author: Espen Albert
 License: MIT
 Classifier: Programming Language :: Python :: 3.10
 Requires-Python: >=3.10
 Description-Content-Type: text/markdown
-Requires-Dist: PyYAML (==5.4.1)
+Requires-Dist: PyYAML (==6.0)
 Requires-Dist: pydantic (==1.9.1)
-Requires-Dist: zero-3rdparty (==0.0.8)
+Requires-Dist: zero-3rdparty (==0.0.9)
 Provides-Extra: json
 Requires-Dist: orjson (>=3.6.5) ; extra == 'json'
 
 # Model-lib - pydantic base models with convenient dump methods
 
 ## Model-lib tutorial: What classes to use as base classes, how to serialize them, and add metadata
 - The models: `Event` and `Entity` are subclassing [pydantic.BaseModel](https://pydantic-docs.helpmanual.io/usage/models/)
```

## Comparing `model_lib-0.0.8.dist-info/RECORD` & `model_lib-0.0.9.dist-info/RECORD`

 * *Files 10% similar despite different names*

```diff
@@ -1,24 +1,24 @@
-model_lib/__init__.py,sha256=Klz3EVEFmfjPD5vKA4JTe1zTzSchMCuEvF4GZvQNHIY,1265
+model_lib/__init__.py,sha256=iZYkTvIf6kInyeQ89JVa_ilIDQki-chvfLzDua3I8y4,1352
 model_lib/base_settings.py,sha256=OXPI1YAwEU4wuV4G537uEs2r9DlOuueYMuuvVYePC6M,7147
 model_lib/constants.py,sha256=KvsUoB01xLYkR4r_919niZiJkSV5CgGa22R7CpgmLu4,601
 model_lib/dump_functions.py,sha256=1U_EXxCEkA5tQYPAHlqxSfmrr_10ctblFbryhjitIfY,1863
 model_lib/errors.py,sha256=Wn_g0euAJtquBV5l4vSVzevRErI9Q-dp7L-lkvG39mg,1631
-model_lib/model_base.py,sha256=i8F9gNXu-ABh_L0Z16g9UiQOia6-FeWlUrTgnPToN3Y,3403
+model_lib/model_base.py,sha256=TRFx9wNL9RQzq9IFzGh0DorTSCT1aswAnbZgzKWgO3w,3299
 model_lib/model_dump.py,sha256=aD8nNqP4P7x6oN09RdUYAbIWSBFudnJFpuVud049k_s,3095
 model_lib/pydantic_utils.py,sha256=_Qu2JKIh-BtD2OyCeiKzPZEMmGvNKyF39z-GBRVWCcg,3101
-model_lib/metadata/__init__.py,sha256=aL052e33uwQqPJrTveZA-Yv-pGLJm2xX-XmQ3x6YKBo,439
+model_lib/metadata/__init__.py,sha256=b_1nhIo33o9sr6KJj0EQ136NDtZn6rguRpQNAuuEk0A,813
 model_lib/metadata/context_dict.py,sha256=WCu_Eqdos6l3484bMtWiD9QO2VRYwtlsY4W5rJrDeOk,5607
 model_lib/metadata/metadata.py,sha256=m8Uec3ebBuWr_LT6vSnKytVWrmRlALyzgSwcilinu1c,1350
 model_lib/metadata/metadata_dump.py,sha256=e6AEYYQbdEhoYEXLLrnIJGqVT97E7QX54-cAkv3l-9k,2558
 model_lib/metadata/metadata_fields.py,sha256=NyKZSFGQKDO-yxYZeMe0RRsWfQJjVrIg4bP2VqXrToc,1277
-model_lib/serialize/__init__.py,sha256=Aw_OS9-sy2TcHam_nlfp4jB-JBAcZOS2Avh3a9ZQoM0,426
-model_lib/serialize/base_64.py,sha256=ETGiro0PpRdTKtZp81EYUbRFMjhKOONtHZwz2VaTtTI,1690
-model_lib/serialize/dump.py,sha256=jfvcZUehu-PmAOJWGq6GO0HayJ0Zgw1LaEU9IFwMqQk,3286
-model_lib/serialize/json_serialize.py,sha256=mhnTAC6Gqc1zs9LqI1knI5Bh9rACA2jVdyV7212G7ow,1773
-model_lib/serialize/parse.py,sha256=4Ckk0tegdXCHnLJCu6qwPXgx1BgroZjfK0wD4YKifmU,6356
-model_lib/serialize/yaml_serialize.py,sha256=cAxstxrW9uecCO5nG54lwnvIj5_7B3eWGSEvPoxRrDA,9871
-model_lib-0.0.8.dist-info/METADATA,sha256=3mAz2TGj4MsqPxBq7J_5j5HoInl56QroVYPZXizGYDA,2603
-model_lib-0.0.8.dist-info/WHEEL,sha256=G16H4A3IeoQmnOrYV4ueZGKSjhipXx8zc8nu9FGlvMA,92
-model_lib-0.0.8.dist-info/namespace_packages.txt,sha256=AbpHGcgLb-kRsJGnwFEktk7uzpZOCcBY74-YBdrKVGs,1
-model_lib-0.0.8.dist-info/top_level.txt,sha256=QvcmctPpLtKFumIeIhNZw09uE9F3BPm20kFJyV_H7_8,10
-model_lib-0.0.8.dist-info/RECORD,,
+model_lib/serialize/__init__.py,sha256=F9Vk0mC9_ITbrNGrmmOdMl1VUyPJBQ2qrE8AU9s154Q,791
+model_lib/serialize/base_64.py,sha256=Or5sz1RCLK_IorxyNf421wyv1QvW5ER0XdpWUDgDdsc,1647
+model_lib/serialize/dump.py,sha256=y8zLJGqhb5SbaVJkgQf6-gHqPDqiJTXdZ6egUYTnt0o,3357
+model_lib/serialize/json_serialize.py,sha256=cFxFNt_iZGDCqyquQRdRWHPanS-9X7nzy4jOAwJU3t4,1773
+model_lib/serialize/parse.py,sha256=NiLJ_Vz7O2Z1YltKqOr-E2PpDiTE3UAI2CvHAP5GzCI,6362
+model_lib/serialize/yaml_serialize.py,sha256=kpm3zMadOdYqWbnpUgHim5vt9MfNBKcytL18luDfdsI,9868
+model_lib-0.0.9.dist-info/METADATA,sha256=wrR8fcto8l10mYeTJoPdlEE7JvNHhATQiJsWuLdytGI,2601
+model_lib-0.0.9.dist-info/WHEEL,sha256=G16H4A3IeoQmnOrYV4ueZGKSjhipXx8zc8nu9FGlvMA,92
+model_lib-0.0.9.dist-info/namespace_packages.txt,sha256=AbpHGcgLb-kRsJGnwFEktk7uzpZOCcBY74-YBdrKVGs,1
+model_lib-0.0.9.dist-info/top_level.txt,sha256=QvcmctPpLtKFumIeIhNZw09uE9F3BPm20kFJyV_H7_8,10
+model_lib-0.0.9.dist-info/RECORD,,
```

